from Crypto.Util.number import *
from secret import flag

# flag = b"caroloctf{REDACTED}"

# generate secrets
p = getPrime(1024)
g = getPrime(1023)

# message
m = bytes_to_long(flag)

# exchange Alice
a = getRandomNBitInteger(1023)
A = (g*a) % p

# exchange Bob
b = getRandomNBitInteger(1023)
B = (g*b) % p

assert (B*a) % p == (A*b) % p

# encrypt flag
c = ((B*a) % p) ^ int.from_bytes(flag, "big")

# print info
print(f"{g = }")
print(f"{p = }")
print(f"{A = }")
print(f"{B = }")
print(f"{c = }")

# output:
# g = 73895400876153353902784019395613353707647167106619944703923604208281840209339912389837201373537560742266912526145499421608286960047959246243926431653532808540400950931804280976959739156410898849987879681771917152850262292977255875147498213624195601734499102934150937652386895600727750621088987643760145582179
# p = 140879366387300162800617888447951957522077642768487218271429129462740160866153961165675653444235156420545130113485644686151933681668670024260130857918672258173150543576658838308719033857660159583418286947042933923991469788140535120018739869365294449918120539516473496081742623792885640382734165264197919472939
# A = 107143351492011303862718750643202157875249969508609018074706437595054796841825009686479257566191224368101455887600675000987964856267825501675808070592116397831406472824765986787443210802132010448064964668162561946850200999675722183314741555918169393479410434896407054853049365538087127869943932274052506172140
# B = 127579240101917311179883245263002313163139708554816223936612308142165315311375922688116176868417886689376738560180040061346163083836149664315970354215930437240536732732530674488241228230845357097864816127949033320662917452999973545951627583896814105782382023525743106411541150107627349593255801635917380710751
# c = 130762794278379333578717586499928530583821590628621490297699516760185063999786094934126114817981949517638801239469477337165613531243579820249706000216407218079091187245802010328136068522197853919305487263617792813113754973932069239915150517088649927228235283011958268339949131706020600746841839824464642946321

